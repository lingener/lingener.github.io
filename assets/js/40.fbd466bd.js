(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{679:function(s,e,t){"use strict";t.r(e);var a=t(3),n=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"redis安装-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis安装-配置"}},[s._v("#")]),s._v(" Redis安装&配置")]),s._v(" "),t("p",[t("strong",[s._v("安装包中ReadMe文件有详细的安装和配置说明")])]),s._v(" "),t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载安装包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v("  http://download.redis.io/releases/redis-5.0.5.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf redis-5.0.5.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" redis-5.0.5 /opt/src/\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/src/redis-5.0.5\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PREFIX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/redis5\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"配置环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置环境变量"}},[s._v("#")]),s._v(" 配置环境变量")]),s._v(" "),t("p",[s._v("修改/etc/profile文件加入如下行")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("export REDIS_HOME=/opt/redis5\nexport PATH=$PATH:$REDIS_HOME/bin\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"配置安装server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置安装server"}},[s._v("#")]),s._v(" 配置安装server")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("利用官方提供的utils配置安装一个server并配置成服务")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" utils\n./install_server.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("Welcome to the redis service installer\nThis script will help you easily set up a running redis server")]),s._v(" "),t("p",[s._v("Please select the redis port for this instance: [6379]\nSelecting default: 6379\nPlease select the redis config file name [/etc/redis/6379.conf]\nSelected default - /etc/redis/6379.conf\nPlease select the redis log file name [/var/log/redis_6379.log]\nSelected default - /var/log/redis_6379.log\nPlease select the data directory for this instance [/var/lib/redis/6379]\nSelected default - /var/lib/redis/6379\nPlease select the redis executable path [] /opt/redis5/bin/redis-server\nSelected config:\nPort           : 6379\nConfig file    : /etc/redis/6379.conf\nLog file       : /var/log/redis_6379.log\nData dir       : /var/lib/redis/6379\nExecutable     : /opt/redis5/bin/redis-server\nCli Executable : /opt/redis5/bin/redis-cli\nIs this ok? Then press ENTER to go on or Ctrl-C to abort.\nCopied /tmp/6379.conf => /etc/init.d/redis_6379\nInstalling service...\nSuccessfully added to chkconfig!\nSuccessfully added to runlevels 345!\nStarting Redis server...\nInstallation successful!")])]),s._v(" "),t("h2",{attrs:{id:"维护server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#维护server"}},[s._v("#")]),s._v(" 维护server")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动Redis服务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" redis_6379 start\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭Redis服务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" redis_6379 stop\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过redis-cli工具发送关闭命令关闭redis")]),s._v("\nredis-cli -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"客户端连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#客户端连接"}},[s._v("#")]),s._v(" 客户端连接")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("redis-cli "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("cmd "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arg "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arg "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nredis-cli -h\n\nredis-cli -n\n\nredis-cli --raw   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#超过ascii的限制时触发编码集显示")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"help @<group>"')]),s._v(" to get a list of commands "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("group"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"help <command>"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" on "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("command"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"help <tab>"')]),s._v(" to get a list of possible "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" topics\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h2",{attrs:{id:"q-a"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#q-a"}},[s._v("#")]),s._v(" Q&A")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("make test报错 "),t("strong",[s._v("You need tcl 8.5 or newer in order to run the Redis test")]),s._v("\n解决方法\nyum install tcl")])]),s._v(" "),t("li",[t("p",[s._v("mac上执行utils/install_server.sh脚本会报错")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("Mmmmm... the default config is missing. Did you switch to the utils directory?")])]),s._v(" "),t("blockquote",[t("ul",[t("li",[t("p",[s._v("原因：Mac不识别install_server.sh中readlink命令，所以无法找到默认配置文件redis.conf在哪儿")])]),s._v(" "),t("li",[t("p",[s._v("解决方案：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("方案一：参见"),t("a",{attrs:{href:"https://blog.csdn.net/libing_zeng/article/details/82953038",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用greadlink命令代替readlink"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[s._v("方案二：修改代码")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("SCRIPT=$(readlink -f $0)\nSCRIPTPATH=$(dirname $SCRIPT)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("修改为")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("SCRIPTPATH=$(cd `dirname $0`; pwd)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])])])])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("ERROR: Could not copy redis init script to /etc/init.d/redis_6379. Aborting!")])]),s._v(" "),t("blockquote",[t("ul",[t("li",[t("p",[s._v("原因：mac里面的服务启动文件不在/etc/init.d目录下")])]),s._v(" "),t("li",[t("p",[s._v("解决方案：不开机启动，注释掉相关代码")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('cp $TMP_FILE $INIT_SCRIPT_DEST && \\\n\tchmod +x $INIT_SCRIPT_DEST || die "Could not copy redis init script to $INIT_SCRIPT_DEST"\necho "Copied $TMP_FILE => $INIT_SCRIPT_DEST"\n\n...\n/etc/init.d/redis_$REDIS_PORT start || die "Failed starting service..."\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("启动")]),s._v(" "),t("p",[s._v("redis-server /etc/redis/6379.conf")])])])])])])])])])}),[],!1,null,null,null);e.default=n.exports}}]);