(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{684:function(e,i,s){"use strict";s.r(i);var t=s(3),r=Object(t.a)({},(function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"redis-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis-api"}},[e._v("#")]),e._v(" Redis_API")]),e._v(" "),s("p",[e._v("https://redis.io/clients#java")]),e._v(" "),s("h2",{attrs:{id:"jedis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jedis"}},[e._v("#")]),e._v(" Jedis")]),e._v(" "),s("p",[e._v("https://github.com/redis/jedis")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("特点")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("线程不安全的")]),e._v(" "),s("p",[e._v("同一个客户端多线程方式访问redis，只创建了一个Jedis对象，如果一个线程开启了事务，那么另外一个线程的操作请求也会被阻塞")]),e._v(" "),s("p",[e._v("**解决方案：**Jedis连接池")])])])]),e._v(" "),s("li",[s("p",[e._v("使用")]),e._v(" "),s("ul",[s("li",[e._v("导入依赖")])])]),e._v(" "),s("li",[s("p",[e._v("异常")]),e._v(" "),s("ul",[s("li",[s("p",[s("strong",[s("code",[e._v("redis.clients.jedis.exceptions.JedisConnectionException: Failed to create socket.")])])]),e._v(" "),s("blockquote",[s("ul",[s("li",[e._v("redis配置中bind可能设置的127.0.0.1，也就是只能本地访问，将bind设置修改成0.0.0.0")]),e._v(" "),s("li",[e._v("防火墙")])])])]),e._v(" "),s("li",[s("p",[s("code",[e._v("redis.clients.jedis.exceptions.JedisDataException: DENIED Redis is running in protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients.")])]),e._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[e._v("原因是")]),e._v(" "),s("ul",[s("li",[e._v("bind配置被去掉了，没有配置")])])]),e._v(" "),s("li",[s("p",[e._v("解决方案（以下任一方法都可）")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("命令关闭保护模式")]),e._v(" "),s("p",[e._v("config set protected-mode no")]),e._v(" "),s("p",[e._v("config rewrite //让配置永久生效")])]),e._v(" "),s("li",[s("p",[e._v("修改配置文件关闭保护模式")]),e._v(" "),s("p",[e._v("protected-mode no")])]),e._v(" "),s("li",[s("p",[e._v("启动参数关闭保护模式")]),e._v(" "),s("p",[e._v("--protected-mode no")])]),e._v(" "),s("li",[s("p",[e._v("配置一个bind地址或者设置一个授权密码")])])])])])])])])])]),e._v(" "),s("h2",{attrs:{id:"lettuce"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lettuce"}},[e._v("#")]),e._v(" lettuce")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("特点")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Synchronous API")])]),e._v(" "),s("li",[s("p",[e._v("Asynchronous API")])]),e._v(" "),s("li",[s("p",[e._v("Reactive API")])])])])]),e._v(" "),s("h2",{attrs:{id:"redisson"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redisson"}},[e._v("#")]),e._v(" Redisson")]),e._v(" "),s("h2",{attrs:{id:"springdata"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#springdata"}},[e._v("#")]),e._v(" SpringData")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("RedisTemplate")]),e._v(" "),s("p",[e._v("使用RedisTemplate执行set之后，直连redis通过**keys ***查看数据会发现key前面有一些特殊字符")]),e._v(" "),s("p",[e._v("原因是RedisTemplate默认使用JdkSerializationRedisSerializer作为序列化工具,按照某个规则在key前面加了什么字符但是通过redisTemplate取值时会得到预期的值，是对key做了相同的处理，如果要改变这种状况需要手动修改序列化方式")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("@Autowired(required = false)\npublic void setRedisTemplate(RedisTemplate redisTemplate) {\n    RedisSerializer stringSerializer = new StringRedisSerializer();\n    redisTemplate.setKeySerializer(stringSerializer);\n    redisTemplate.setValueSerializer(stringSerializer);\n    redisTemplate.setHashKeySerializer(stringSerializer);\n    redisTemplate.setHashValueSerializer(stringSerializer);\n    this.redisTemplate = redisTemplate;\n}\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("StringRedisTemplate")])]),e._v(" "),s("li",[s("p",[e._v("问题管理")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("**"),s("code",[e._v("org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 192.168.137.101:6379**")])]),e._v(" "),s("blockquote",[s("p",[s("strong",[e._v("连接超时，偶尔能成功")])]),e._v(" "),s("p",[e._v("解决方案：spring.redis.timeout 不要设置为0")]),e._v(" "),s("p",[s("strong",[e._v("如果是一直连接不上需要考虑是不是保护模式的问题或者防火墙")])])])])])])])])}),[],!1,null,null,null);i.default=r.exports}}]);