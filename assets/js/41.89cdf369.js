(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{680:function(v,_,s){"use strict";s.r(_);var t=s(3),e=Object(t.a)({},(function(){var v=this,_=v.$createElement,s=v._self._c||_;return s("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[s("h1",{attrs:{id:"redis数据存储类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis数据存储类型"}},[v._v("#")]),v._v(" Redis数据存储类型")]),v._v(" "),s("h2",{attrs:{id:"key"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key"}},[v._v("#")]),v._v(" key")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("type")]),v._v(" "),s("p",[v._v("数据的类型，插入数据的时候命令是哪个group的，数据类型就是哪个")]),v._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[v._v("set k1 123\ntype k1\nhelp set // set是属于string这个group的\n")])]),v._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[v._v("1")]),s("br"),s("span",{staticClass:"line-number"},[v._v("2")]),s("br"),s("span",{staticClass:"line-number"},[v._v("3")]),s("br")])])]),v._v(" "),s("li",[s("p",[v._v("encoding")]),v._v(" "),s("p",[v._v("限制某些操作的数据类型")]),v._v(" "),s("ul",[s("li",[v._v("raw")]),v._v(" "),s("li",[v._v("int")]),v._v(" "),s("li",[v._v("embstr")])])])]),v._v(" "),s("h2",{attrs:{id:"value"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#value"}},[v._v("#")]),v._v(" value")]),v._v(" "),s("h3",{attrs:{id:"string-byte"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#string-byte"}},[v._v("#")]),v._v(" string（byte）")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("字符串")]),v._v(" "),s("p",[v._v("提供了基本的set、get、append、setrange、getrange、strlen等命令")])]),v._v(" "),s("li",[s("p",[v._v("数值")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("使用场景")]),v._v(" "),s("p",[v._v("incr")]),v._v(" "),s("ul",[s("li",[v._v("抢购、秒杀、详情页、点赞、评论")])]),v._v(" "),s("p",[v._v("规避并发下对数据库的事物操作，完全由redis内存操作代替")])])])]),v._v(" "),s("li",[s("p",[v._v("bitmap")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("使用场景")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("用户系统，统计用户登陆天数，随机窗口")]),v._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[v._v("setbit sean 7 1\nsetbit sean 30 1\nsetbit sean 264 1\nstrlen sean\nbitcount sean -2 -1\n")])]),v._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[v._v("1")]),s("br"),s("span",{staticClass:"line-number"},[v._v("2")]),s("br"),s("span",{staticClass:"line-number"},[v._v("3")]),s("br"),s("span",{staticClass:"line-number"},[v._v("4")]),s("br"),s("span",{staticClass:"line-number"},[v._v("5")]),s("br")])])]),v._v(" "),s("li",[s("p",[v._v("京东618做活动，登陆就送礼物，需要备多少货（2E用户）——活跃用户统计")]),v._v(" "),s("p",[v._v("比如说 1号~3号 连续登录要   去重")]),v._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[v._v("setbit 20190101  1 1\nsetbit 20190102  1 1\nsetbit 20190102  7 1\nbitop or  destkey 20190101 20190102\nBITCOUNT destkey 0 -1\n")])]),v._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[v._v("1")]),s("br"),s("span",{staticClass:"line-number"},[v._v("2")]),s("br"),s("span",{staticClass:"line-number"},[v._v("3")]),s("br"),s("span",{staticClass:"line-number"},[v._v("4")]),s("br"),s("span",{staticClass:"line-number"},[v._v("5")]),s("br")])])])])])])])]),v._v(" "),s("h3",{attrs:{id:"list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#list"}},[v._v("#")]),v._v(" List")]),v._v(" "),s("p",[s("img",{attrs:{src:"/Users/lijinling/Documents/svn/myRepo/Coding/DayDayUp/Middleware/Cache/Redis/images/Redis_List模型.png",alt:"image-20210712175422276"}})]),v._v(" "),s("ul",[s("li",[s("p",[v._v("实现数据结构“栈”")]),v._v(" "),s("p",[v._v("FIFO，同向命令（lpush、lpop）")])]),v._v(" "),s("li",[s("p",[v._v("实现“队列”")]),v._v(" "),s("p",[v._v("反向命令（lpush、rpop）")])]),v._v(" "),s("li",[s("p",[v._v("实现“数组”")]),v._v(" "),s("p",[v._v("lindex、lset")])]),v._v(" "),s("li",[s("p",[v._v("实现“阻塞的单播队列”")]),v._v(" "),s("p",[v._v("blpop")])])]),v._v(" "),s("h3",{attrs:{id:"hash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hash"}},[v._v("#")]),v._v(" hash")]),v._v(" "),s("ul",[s("li",[v._v("可以对field进行数值计算")]),v._v(" "),s("li",[v._v("使用场景\n"),s("ul",[s("li",[v._v("点赞")]),v._v(" "),s("li",[v._v("收藏")]),v._v(" "),s("li",[v._v("详情页")])])])]),v._v(" "),s("h3",{attrs:{id:"set"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#set"}},[v._v("#")]),v._v(" set")]),v._v(" "),s("ul",[s("li",[v._v("特点\n"),s("ul",[s("li",[v._v("去重的")]),v._v(" "),s("li",[v._v("乱序的")]),v._v(" "),s("li",[v._v("集合操作比较多")]),v._v(" "),s("li",[v._v("随机事件")])])]),v._v(" "),s("li",[v._v("使用场景\n"),s("ul",[s("li",[v._v("可重复抽奖（srandmember count < 0）")]),v._v(" "),s("li",[v._v("不可重复抽奖（srandmember count > 0）")]),v._v(" "),s("li",[v._v("一次抽一个（spop）")])])])]),v._v(" "),s("h3",{attrs:{id:"sorted-set"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sorted-set"}},[v._v("#")]),v._v(" sorted set")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("特点")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("物理内存左小右大，不随命令发生变化")])]),v._v(" "),s("li",[s("p",[v._v("集合操作")]),v._v(" "),s("p",[v._v("权重、聚合指令")])])])]),v._v(" "),s("li",[s("p",[v._v("排序是怎么实现的")]),v._v(" "),s("p",[v._v("skip list 跳跃表")]),v._v(" "),s("p",[s("img",{attrs:{src:"/Users/lijinling/Documents/svn/myRepo/Coding/DayDayUp/Middleware/Cache/Redis/images/Redis_跳跃表结构.png",alt:"image-20210713111645821"}})]),v._v(" "),s("ul",[s("li",[s("p",[v._v("结构解析")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("header:指向跳跃表的表头节点，通过这个指针程序定位表头节点的时间复杂度就为O(1)")])]),v._v(" "),s("li",[s("p",[v._v("tail:指向跳跃表的表尾节点,通过这个指针程序定位表尾节点的时间复杂度就为O(1)")])]),v._v(" "),s("li",[s("p",[v._v("level:记录目前跳跃表内,层数最大的那个节点的层数(表头节点的层数不计算在内)，通过这个属性可以再O(1)的时间复杂度内获取层高最好的节点的层数。")])]),v._v(" "),s("li",[s("p",[v._v("length:记录跳跃表的长度,也即是,跳跃表目前包含节点的数量(表头节点不计算在内)，通过这个属性，程序可以再O(1)的时间复杂度内返回跳跃表的长度。")]),v._v(" "),s("p",[v._v("结构右方的是四个 zskiplistNode结构,该结构包含以下属性")])]),v._v(" "),s("li",[s("p",[v._v("层(level):")]),v._v(" "),s("p",[v._v("节点中用L1、L2、L3等字样标记节点的各个层,L1代表第一层,L2代表第二层,以此类推。")]),v._v(" "),s("p",[v._v("每个层都带有两个属性:前进指针和跨度。前进指针用于访问位于表尾方向的其他节点,而跨度则记录了前进指针所指向节点和当前节点的距离(跨度越大、距离越远)。在上图中,连线上带有数字的箭头就代表前进指针,而那个数字就是跨度。当程序从表头向表尾进行遍历时,访问会沿着层的前进指针进行。")]),v._v(" "),s("p",[v._v("每次创建一个新跳跃表节点的时候,程序都根据幂次定律(powerlaw,越大的数出现的概率越小)随机生成一个介于1和32之间的值作为level数组的大小,这个大小就是层的“高度”。")])]),v._v(" "),s("li",[s("p",[v._v("后退(backward)指针：")]),v._v(" "),s("p",[v._v("节点中用BW字样标记节点的后退指针,它指向位于当前节点的前一个节点。后退指针在程序从表尾向表头遍历时使用。与前进指针所不同的是每个节点只有一个后退指针，因此每次只能后退一个节点。")])]),v._v(" "),s("li",[s("p",[v._v("分值(score):")]),v._v(" "),s("p",[v._v("各个节点中的1.0、2.0和3.0是节点所保存的分值。在跳跃表中,节点按各自所保存的分值从小到大排列。")])]),v._v(" "),s("li",[s("p",[v._v("成员对象(oj):")]),v._v(" "),s("p",[v._v("各个节点中的o1、o2和o3是节点所保存的成员对象。在同一个跳跃表中,各个节点保存的成员对象必须是唯一的,但是多个节点保存的分值却可以是相同的:分值相同的节点将按照成员对象在字典序中的大小来进行排序,成员对象较小的节点会排在前面(靠近表头的方向),而成员对象较大的节点则会排在后面(靠近表尾的方向)。")])])])]),v._v(" "),s("li",[s("p",[v._v("操作")]),v._v(" "),s("ul",[s("li",[s("p",[v._v("查询")]),v._v(" "),s("p",[v._v("从上往下查询")])]),v._v(" "),s("li",[s("p",[v._v("插入")]),v._v(" "),s("ol",[s("li",[s("p",[v._v("随机确定层数k")]),v._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[v._v("int random_level()\n{\n    K = 1;\n    while (random(0,1))\n        K++;\n    return K;\n}\n")])]),v._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[v._v("1")]),s("br"),s("span",{staticClass:"line-number"},[v._v("2")]),s("br"),s("span",{staticClass:"line-number"},[v._v("3")]),s("br"),s("span",{staticClass:"line-number"},[v._v("4")]),s("br"),s("span",{staticClass:"line-number"},[v._v("5")]),s("br"),s("span",{staticClass:"line-number"},[v._v("6")]),s("br"),s("span",{staticClass:"line-number"},[v._v("7")]),s("br")])])]),v._v(" "),s("li",[s("p",[v._v("往level k 到level 1都插入数据")])]),v._v(" "),s("li",[s("p",[v._v("如果k > 当前层数则加层")])])])]),v._v(" "),s("li",[s("p",[v._v("删除")]),v._v(" "),s("p",[v._v("各层中找到元素依次删除")])]),v._v(" "),s("li",[s("p",[v._v("常用操作的时间复杂度")]),v._v(" "),s("table",[s("thead",[s("tr",[s("th",[v._v("跃表")]),v._v(" "),s("th",[v._v("O(1)")])])]),v._v(" "),s("tbody",[s("tr",[s("td",[v._v("创建一个跳跃表")]),v._v(" "),s("td",[v._v("O(1)")])]),v._v(" "),s("tr",[s("td",[v._v("释放给定跳跃表以及其中包含的节点")]),v._v(" "),s("td",[v._v("O(N)")])]),v._v(" "),s("tr",[s("td",[v._v("添加给定成员和分值的新节点")]),v._v(" "),s("td",[v._v("平均O(logN),最坏O(logN)(N为跳跃表的长度)")])]),v._v(" "),s("tr",[s("td",[v._v("删除除跳跃表中包含给定成员和分值的节点")]),v._v(" "),s("td",[v._v("平均O(logN),最坏O(logN)(N为跳跃表的长度)")])]),v._v(" "),s("tr",[s("td",[v._v("返回给定成员和分值的节点再表中的排位")]),v._v(" "),s("td",[v._v("平均O(logN),最坏O(logN)(N为跳跃表的长度)")])]),v._v(" "),s("tr",[s("td",[v._v("返回在给定排位上的节点")]),v._v(" "),s("td",[v._v("平均O(logN),最坏O(logN)(N为跳跃表的长度)")])]),v._v(" "),s("tr",[s("td",[v._v("给定一个分值范围,返回跳跃表中第一个符合这个范围的节点")]),v._v(" "),s("td",[v._v("O(1)")])]),v._v(" "),s("tr",[s("td",[v._v("给定一个分值范围,返回跳跃表中最后一个符合这个范围的节点")]),v._v(" "),s("td",[v._v("平均O(logN),最坏O(logN)(N为跳跃表的长度)")])]),v._v(" "),s("tr",[s("td",[v._v("给定一个分值范围,除跳跃表中所有在这个范围之内的节点")]),v._v(" "),s("td",[v._v("平均O(logN),最坏O(logN)(N为跳跃表的长度)")])]),v._v(" "),s("tr",[s("td",[v._v("给定一个排位范围,鼎除跳跃表中所有在这个范围之内的节点")]),v._v(" "),s("td",[v._v("O(N),N为被除节点数量")])]),v._v(" "),s("tr",[s("td",[v._v("给定一个分值范固(range),比如0到15,20到28,诸如此类,如果跳氏表中有至少一个节点的分值在这个范間之内,那么返回1,否则返回0")]),v._v(" "),s("td",[v._v("O(N),N为被除节点数量")])])])])])])])])]),v._v(" "),s("li",[s("p",[v._v("使用场景")]),v._v(" "),s("ul",[s("li",[v._v("排行榜")])])])])])}),[],!1,null,null,null);_.default=e.exports}}]);